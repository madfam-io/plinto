# Default values for Plinto
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

global:
  environment: production
  domain: plinto.dev
  
replicaCount:
  api: 3
  admin: 2
  dashboard: 2
  docs: 1
  marketing: 2
  edgeVerify: 5

image:
  registry: docker.io
  repository: plinto
  pullPolicy: IfNotPresent
  tag: "v1.0.0"

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

# API Service Configuration
api:
  enabled: true
  name: api
  replicaCount: 3
  image:
    repository: plinto/api
    tag: latest
  service:
    type: ClusterIP
    port: 8000
  ingress:
    enabled: true
    host: api.plinto.dev
    tls:
      enabled: true
      secretName: plinto-api-tls
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 500m
      memory: 512Mi
  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 10
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80
  env:
    DATABASE_URL: ""
    REDIS_URL: ""
    JWT_SECRET_KEY: ""
    JWT_ALGORITHM: "RS256"
    CORS_ORIGINS: "*"
    RATE_LIMIT_ENABLED: "true"
    RATE_LIMIT_PER_MINUTE: "100"

# Admin Portal Configuration
admin:
  enabled: true
  name: admin
  replicaCount: 2
  image:
    repository: plinto/admin
    tag: latest
  service:
    type: ClusterIP
    port: 3000
  ingress:
    enabled: true
    host: admin.plinto.dev
    tls:
      enabled: true
      secretName: plinto-admin-tls
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 250m
      memory: 256Mi

# Dashboard Configuration
dashboard:
  enabled: true
  name: dashboard
  replicaCount: 2
  image:
    repository: plinto/dashboard
    tag: latest
  service:
    type: ClusterIP
    port: 3000
  ingress:
    enabled: true
    host: app.plinto.dev
    tls:
      enabled: true
      secretName: plinto-dashboard-tls
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 250m
      memory: 256Mi

# Documentation Site Configuration
docs:
  enabled: true
  name: docs
  replicaCount: 1
  image:
    repository: plinto/docs
    tag: latest
  service:
    type: ClusterIP
    port: 3000
  ingress:
    enabled: true
    host: docs.plinto.dev
    tls:
      enabled: true
      secretName: plinto-docs-tls
  resources:
    limits:
      cpu: 250m
      memory: 256Mi
    requests:
      cpu: 100m
      memory: 128Mi

# Marketing Site Configuration
marketing:
  enabled: true
  name: marketing
  replicaCount: 2
  image:
    repository: plinto/marketing
    tag: latest
  service:
    type: ClusterIP
    port: 3000
  ingress:
    enabled: true
    host: www.plinto.dev
    tls:
      enabled: true
      secretName: plinto-marketing-tls
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 250m
      memory: 256Mi

# Edge Verification Workers
edgeVerify:
  enabled: true
  name: edge-verify
  replicaCount: 5
  image:
    repository: plinto/edge-verify
    tag: latest
  service:
    type: ClusterIP
    port: 8787
  resources:
    limits:
      cpu: 250m
      memory: 128Mi
    requests:
      cpu: 100m
      memory: 64Mi

# PostgreSQL Configuration
postgresql:
  enabled: true
  auth:
    postgresPassword: "changeme"
    username: "plinto"
    password: "changeme"
    database: "plinto"
  architecture: replication
  primary:
    persistence:
      enabled: true
      size: 20Gi
      storageClass: "gp3"
  readReplicas:
    replicaCount: 2
    persistence:
      enabled: true
      size: 20Gi
      storageClass: "gp3"
  metrics:
    enabled: true
  backup:
    enabled: true
    cronjob:
      schedule: "0 2 * * *"
      storage:
        size: 50Gi

# Redis Configuration
redis:
  enabled: true
  auth:
    enabled: true
    password: "changeme"
  architecture: replication
  master:
    persistence:
      enabled: true
      size: 8Gi
  replica:
    replicaCount: 2
    persistence:
      enabled: true
      size: 8Gi
  metrics:
    enabled: true

# Elasticsearch Configuration (for audit logs)
elasticsearch:
  enabled: true
  master:
    replicaCount: 3
    persistence:
      enabled: true
      size: 10Gi
  data:
    replicaCount: 2
    persistence:
      enabled: true
      size: 30Gi
  coordinating:
    replicaCount: 2
  metrics:
    enabled: true

# Ingress Configuration
ingress:
  enabled: true
  className: "nginx"
  annotations:
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
    nginx.ingress.kubernetes.io/rate-limit: "100"
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
    nginx.ingress.kubernetes.io/proxy-body-size: "10m"
  tls:
    enabled: true

# Service Account
serviceAccount:
  create: true
  annotations: {}
  name: ""

# Pod Security Context
podSecurityContext:
  runAsNonRoot: true
  runAsUser: 1000
  fsGroup: 1000

# Security Context
securityContext:
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: true
  runAsNonRoot: true
  runAsUser: 1000
  allowPrivilegeEscalation: false

# Monitoring
monitoring:
  enabled: true
  prometheus:
    enabled: true
    serviceMonitor:
      enabled: true
      interval: 30s
  grafana:
    enabled: true
    dashboards:
      enabled: true

# Backup Configuration
backup:
  enabled: true
  schedule: "0 2 * * *"
  retention: 30
  storage:
    type: s3
    bucket: plinto-backups
    region: us-east-1
    endpoint: ""
    accessKey: ""
    secretKey: ""

# Network Policies
networkPolicy:
  enabled: true
  policyTypes:
    - Ingress
    - Egress

# Pod Disruption Budget
podDisruptionBudget:
  enabled: true
  minAvailable: 1

# Resource Quotas
resourceQuota:
  enabled: false
  limits:
    cpu: "100"
    memory: "100Gi"
    persistentvolumeclaims: "10"

# Node Selector
nodeSelector: {}

# Tolerations
tolerations: []

# Affinity
affinity:
  podAntiAffinity:
    preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 100
        podAffinityTerm:
          labelSelector:
            matchExpressions:
              - key: app
                operator: In
                values:
                  - plinto
          topologyKey: kubernetes.io/hostname